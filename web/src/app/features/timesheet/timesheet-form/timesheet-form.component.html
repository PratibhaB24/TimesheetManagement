<form [formGroup]="timesheetForm" (ngSubmit)="onSubmit()">
  <div class="form-group">
    <label>Submission Date</label>
    <input type="date" formControlName="submissionDate" class="form-control" />
  </div>

  <div class="entries-section">
    <div class="entries-header">
      <h4>Time Entries</h4>
      <button type="button" class="btn btn-add" (click)="addEntry()">+ Add Entry</button>
    </div>

    <div formArrayName="entries">
      @for (entry of entries.controls; track $index; let i = $index) {
      <div class="entry-card" [formGroupName]="i">
        <div class="entry-row">
          <div class="form-group">
            <label>Project</label>
            <select formControlName="projectId" class="form-control">
              <option value="">Select Project</option>
              @for (assignment of assignments(); track assignment.id) {
              <option [value]="assignment.projectId">
                {{ assignment.projectCode }} - {{ assignment.projectName }}
              </option>
              }
            </select>
          </div>

          <div class="form-group">
            <label>Date</label>
            <input type="date" formControlName="date" class="form-control" />
          </div>

          <div class="form-group">
            <label>Hours</label>
            <input
              type="number"
              formControlName="hours"
              class="form-control"
              min="0.25"
              max="24"
              step="0.25"
            />
          </div>
        </div>

        <div class="form-group">
          <label>Description</label>
          <input
            type="text"
            formControlName="description"
            class="form-control"
            placeholder="What did you work on?"
          />
        </div>

        <button type="button" class="btn btn-remove" (click)="removeEntry(i)">Remove</button>
      </div>
      }
    </div>

    @if (entries.length === 0) {
    <p class="no-entries">No entries yet. Click "Add Entry" to start.</p>
    }
  </div>

  <div class="form-actions">
    <button
      type="submit"
      class="btn btn-primary"
      [disabled]="!timesheetForm.valid || entries.length === 0"
    >
      Create Timesheet
    </button>
  </div>
</form>
